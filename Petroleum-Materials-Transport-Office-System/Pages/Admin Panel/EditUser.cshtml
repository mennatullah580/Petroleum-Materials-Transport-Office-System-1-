@page
@model Petroleum_Materials_Transport_Office_System.Pages.AdminPanel.EditUserModel
@{
    ViewData["Title"] = "تعديل/إضافة مستخدم";
}

<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>

    <!-- Bootstrap RTL -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
    <!-- Cairo Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f0f0f0;
            padding-bottom: 40px;
        }

        .admin-panel {
            background: linear-gradient(135deg, #567C8D 0%, #4a6b7a 100%);
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            margin: 25px auto;
            max-width: 1000px;
            padding: 30px;
            position: relative;
            overflow: hidden;
        }

        .panel-header {
            background: white;
            border-radius: 12px;
            text-align: center;
            font-weight: 700;
            font-size: 1.4rem;
            color: #333;
            padding: 14px;
            margin-bottom: 28px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-shadow: 0.5px 0.5px 1px rgba(0,0,0,0.1);
        }

        .section-title {
            font-weight: 600;
            color: white;
            margin: 28px 0 16px;
            font-size: 1.15rem;
            position: relative;
            padding-right: 10px;
        }

            .section-title::after {
                content: '';
                position: absolute;
                right: 0;
                bottom: -6px;
                width: 50px;
                height: 3px;
                background: #ffd700; /* Gold accent */
                border-radius: 3px;
            }

        /* Form Layout */
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 18px;
        }

        .form-group {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .form-label {
            color: white;
            font-weight: 500;
            margin-bottom: 6px;
            font-size: 0.95rem;
            text-align: right;
            text-shadow: 0.5px 0.5px 1px rgba(0,0,0,0.3);
        }

        .form-control, .form-select {
            background-color: #F5EFE8;
            border: 1px solid #d0c8c0;
            border-radius: 12px;
            padding: 10px 14px;
            font-family: 'Cairo', sans-serif;
            font-size: 0.95rem;
            direction: rtl;
            text-align: right;
            transition: all 0.2s;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }

            .form-control:focus, .form-select:focus {
                outline: none;
                border-color: #ffd700;
                box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3), inset 0 1px 3px rgba(0,0,0,0.1);
                background-color: #fff;
            }

        /* Permissions Box */
        .permissions-box {
            background: #ffffff;
            border-radius: 14px;
            padding: 20px;
            margin-top: 10px;
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .permission-group {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #e0e0e0;
        }

            .permission-group:last-child {
                border-bottom: none;
                margin-bottom: 0;
                padding-bottom: 0;
            }

        .permission-group-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.05rem;
            padding-right: 5px;
        }

        /* --- FIXED CHECKBOXES (RTL) --- */
        .form-check {
            display: flex;
            align-items: flex-start;
            gap: 30px;
            margin: 10px 0;
            cursor: pointer;
        }

        .form-check-input {
            width: 20px;
            height: 20px;
            border: 2px solid #5a9bcf;
            border-radius: 4px;
            background-color: white;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
            transition: all 0.2s;
        }

            .form-check-input:checked {
                background-color: #5a9bcf;
                border-color: #5a9bcf;
            }

                .form-check-input:checked::after {
                    content: '✓';
                    font-size: 14px;
                    color: white;
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    font-weight: bold;
                    text-shadow: 0 1px 1px rgba(0,0,0,0.2);
                }

            .form-check-input:focus {
                outline: none;
                box-shadow: 0 0 0 3px rgba(90, 155, 207, 0.3);
            }

        .form-check-label {
            font-size: 0.95rem;
            color: #2c3e50;
            line-height: 1.4;
            cursor: pointer;
            user-select: none;
            text-align: right;
            direction: rtl;
            flex-grow: 1;
            padding-top: 2px;
        }

        /* --- RADIO BUTTONS (نشط / غير نشط) --- */
        .radio-group {
            display: flex;
            gap: 30px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .form-check-inline {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0;
        }

            .form-check-inline .form-check-input {
                width: 20px;
                height: 20px;
                border-radius: 50%;
                margin: 0;
                flex-shrink: 0;
            }

            .form-check-inline .form-check-label {
                margin: 0;
                text-align: right;
                direction: rtl;
                color: white;
                text-shadow: 0.5px 0.5px 1px rgba(0,0,0,0.5);
                font-weight: 500;
            }

        /* Buttons */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn-save, .btn-cancel {
            font-weight: 600;
            padding: 12px 32px;
            border-radius: 14px;
            font-size: 1.05rem;
            transition: all 0.25s;
            border: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }

        .btn-save {
            background: linear-gradient(to bottom, #ffd700, #ffb700);
            color: #2c3e50;
            font-weight: 700;
        }

            .btn-save:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 15px rgba(255, 215, 0, 0.4);
                background: linear-gradient(to bottom, #fff04d, #ffcc00);
            }

        .btn-cancel {
            background: linear-gradient(to bottom, #e0e0e0, #cccccc);
            color: #333;
        }

            .btn-cancel:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 15px rgba(0,0,0,0.2);
                background: linear-gradient(to bottom, #f0f0f0, #d9d9d9);
            }

        /* Responsive */
        @@media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 12px;
            }

            .radio-group {
                flex-direction: column;
                gap: 15px;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .btn-save, .btn-cancel {
                width: 100%;
                max-width: 280px;
                padding: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="admin-panel">
            <div class="panel-header">تعديل/إضافة مستخدم</div>

            <form method="post">
                <!-- Basic Info -->
                <div class="section-title">معلومات المستخدم</div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">الاسم الكامل</label>
                        <input type="text" class="form-control" asp-for="User.FullName" placeholder="أدخل الاسم الكامل" />
                    </div>
                    <div class="form-group">
                        <label class="form-label">اسم المستخدم</label>
                        <input type="text" class="form-control" asp-for="User.Username" placeholder="أدخل اسم المستخدم" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">البريد الإلكتروني</label>
                        <input type="email" class="form-control" asp-for="User.Email" placeholder="example@domain.com" />
                    </div>
                    <div class="form-group">
                        <label class="form-label">رقم الهاتف</label>
                        <input type="text" class="form-control" asp-for="User.Phone" placeholder="05XXXXXXXX" />
                    </div>
                </div>

                <!-- Role & Department -->
                <div class="section-title">الصلاحيات الوظيفية</div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">الدور</label>
                        <select class="form-select" asp-for="User.Role" asp-items="Model.Roles">
                            <option value="">اختر الدور</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">القسم</label>
                        <input type="text" class="form-control" asp-for="User.Department" placeholder="أدخل القسم" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">الفرع المسند</label>
                        <input type="text" class="form-control" asp-for="User.AssignedBranch" placeholder="أدخل الفرع" />
                    </div>
                    <div class="form-group"></div>
                </div>

                <!-- Password -->
                <div class="section-title">كلمة المرور</div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">كلمة المرور</label>
                        <input type="password" class="form-control" asp-for="User.Password" placeholder="أدخل كلمة المرور" />
                    </div>
                    <div class="form-group">
                        <label class="form-label">تأكيد كلمة المرور</label>
                        <input type="password" class="form-control" asp-for="User.ConfirmPassword" placeholder="أعد إدخال كلمة المرور" />
                    </div>
                </div>

                <!-- Detailed Permissions -->
                <div class="section-title">الصلاحيات التفصيلية</div>
                <div class="permissions-box">
                    <div class="permission-group">
                        <div class="permission-group-title">إدارة الطلبات</div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanViewOrders" id="viewOrders" />
                            <label class="form-check-label" for="viewOrders">عرض الطلبات</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanCreateOrders" id="createOrders" />
                            <label class="form-check-label" for="createOrders">إنشاء طلبات جديدة</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanEditOrders" id="editOrders" />
                            <label class="form-check-label" for="editOrders">تعديل الطلبات</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanDeleteOrders" id="deleteOrders" />
                            <label class="form-check-label" for="deleteOrders">حذف الطلبات</label>
                        </div>
                    </div>

                    <div class="permission-group">
                        <div class="permission-group-title">التقارير والماليات</div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanViewFinancialReports" id="viewFinReports" />
                            <label class="form-check-label" for="viewFinReports">عرض التقارير المالية</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanViewProfitReports" id="viewProfitReports" />
                            <label class="form-check-label" for="viewProfitReports">عرض تقارير الأرباح</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanExportReports" id="exportReports" />
                            <label class="form-check-label" for="exportReports">تصدير التقارير</label>
                        </div>
                    </div>

                    <div class="permission-group">
                        <div class="permission-group-title">إدارة الحسابات</div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanAccessContractors" id="accessContractors" />
                            <label class="form-check-label" for="accessContractors">الوصول لحسابات المقاولين</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanEditContractors" id="editContractors" />
                            <label class="form-check-label" for="editContractors">تعديل بيانات المقاولين</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanManagePayments" id="managePayments" />
                            <label class="form-check-label" for="managePayments">إدارة المدفوعات</label>
                        </div>
                    </div>

                    <div class="permission-group">
                        <div class="permission-group-title">إعدادات النظام</div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanManageFuelPrices" id="manageFuel" />
                            <label class="form-check-label" for="manageFuel">إدارة أسعار الوقود</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanManageUsers" id="manageUsers" />
                            <label class="form-check-label" for="manageUsers">إدارة المستخدمين</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanManageDeductions" id="manageDeductions" />
                            <label class="form-check-label" for="manageDeductions">إدارة الاستقطاعات</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" asp-for="Permissions.CanViewSystemLogs" id="viewLogs" />
                            <label class="form-check-label" for="viewLogs">عرض سجلات النظام</label>
                        </div>
                    </div>
                </div>

                <!-- Status -->
                <div class="section-title">الحالة</div>
                <div class="radio-group">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" asp-for="User.IsActive" value="true" id="active" />
                        <label class="form-check-label" for="active">نشط</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" asp-for="User.IsActive" value="false" id="inactive" />
                        <label class="form-check-label" for="inactive">غير نشط</label>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="action-buttons">
                    <button type="submit" class="btn btn-save">حفظ</button>
                    <a href="/AdminPanel/UserManagement" class="btn btn-cancel">إلغاء</a>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>